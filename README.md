# LianPkg âœ¨

LianPkg æ˜¯ä¸€ä¸ªç”¨äºå¤„ç† Wallpaper Engine å£çº¸èµ„æºçš„ç»¼åˆå·¥å…·ã€‚å®ƒå¯ä»¥æå–å£çº¸æ–‡ä»¶ã€è§£åŒ… `.pkg` æ–‡ä»¶ä»¥åŠå°† `.tex` çº¹ç†è½¬æ¢ä¸ºå¸¸è§çš„å›¾åƒæ ¼å¼ï¼Œæ”¯æŒ Linux ä¸ Windowsã€‚

---

## ä½¿ç”¨å‰é¡»çŸ¥ï¼ˆé‡è¦ï¼‰âš ï¸

ç”±äº LianPkg çš„å·¥ä½œå¯¹è±¡æ˜¯ Steam Workshop ä¸­çš„ Wallpaper Engine å£çº¸èµ„æºï¼Œé»˜è®¤å¤„ç†ç›®å½•ä¸ºï¼š

```swift
~/.local/share/Steam/steamapps/workshop/content/431960
```

å› æ­¤ï¼Œåœ¨ä½¿ç”¨æœ¬å·¥å…·ä¹‹å‰ï¼Œè¯·ç¡®ä¿ä½ çš„æœºå™¨ä¸Š å·²ç»å®‰è£…å¹¶è‡³å°‘è¿è¡Œè¿‡ä¸€æ¬¡æ¥è‡ª Linux Steam å®˜æ–¹çš„ Wallpaper Engineï¼Œå¹¶ä¸”å·²ç»é€šè¿‡ Steam ä¸‹è½½è¿‡å£çº¸å†…å®¹ã€‚

å¦‚æœæœ¬åœ°ä¸å­˜åœ¨ä¸Šè¿°ç›®å½•æˆ–ç›®å½•ä¸ºç©ºï¼ŒLianPkg å°†æ— æ³•æ‰¾åˆ°ä»»ä½•å¯å¤„ç†çš„å£çº¸èµ„æº ğŸ¾

> å…¶å®ä½ ä¹Ÿå¯ä»¥è‡ªè¡Œä¸‹è½½ `.pkg` æ–‡ä»¶ï¼Œå¹¶ä¿®æ”¹ç¨‹åºçš„å¤„ç†è·¯å¾„ï¼Œä½†æœ¬ç¨‹åºæ¨èæ‚¨åœ¨å®˜æ–¹ Wallpaper Engine è·å–å®‰å…¨çš„å£çº¸æ–‡ä»¶

## å®‰è£… ğŸ“¦

ä½ å¯ä»¥ç›´æ¥åœ¨ Releases é¡µé¢ä¸‹è½½ç¼–è¯‘å¥½çš„äºŒè¿›åˆ¶æ–‡ä»¶ä½¿ç”¨ï¼ˆæä¾› Linux ä¸ Windows ç‰ˆæœ¬ï¼‰ã€‚

æˆ–è€…ï¼Œå¦‚æœä½ æƒ³è‡ªå·±ç¼–è¯‘ï¼Œè¯·ç¡®ä¿ä½ å·²ç»å®‰è£…äº† Rust å’Œ Cargoï¼š

```bash
cargo build --release
```

ç¼–è¯‘åçš„äºŒè¿›åˆ¶æ–‡ä»¶ä½äº `target/release/lianpkg`ã€‚

#### ArchLinux

å¯ä»¥é€šè¿‡AURå®‰è£… [lianpkg-bin](https://aur.archlinux.org/packages/lianpkg-bin)

```shell
yay -S lianpkg-bin

#æˆ–ä½¿ç”¨paru
paru -S lianpkg-bin
```

---

## é…ç½® ğŸ› ï¸

é¦–æ¬¡è¿è¡Œæ—¶ï¼ŒLianPkg ä¼šç”Ÿæˆé»˜è®¤é…ç½®æ–‡ä»¶ï¼š
- Linux: `~/.config/lianpkg/default.toml`
- Windows: ä¸ exe åŒç›®å½•ï¼ˆä¾¿æºåŒ–ï¼›å¯ç”¨ `--config` æŒ‡å®šå…¶ä»–è·¯å¾„ï¼‰

ä½ å¯ä»¥åœ¨åŒä¸€ç›®å½•ä¸‹åˆ›å»º `config.toml` æ¥è¦†ç›–ç‰¹å®šè®¾ç½®ã€‚ç¨‹åºçš„é…ç½®ä¼˜å…ˆçº§å¦‚ä¸‹ï¼š
1. **å‘½ä»¤è¡Œå‚æ•°**
2. `config.toml`
3. `default.toml`
4. **ç¡¬ç¼–ç é»˜è®¤å€¼**

---

## ä½¿ç”¨è¯´æ˜ï¼ˆå…¨æ–° CLIï¼‰ğŸš€

```bash
lianpkg <æ¨¡å¼> [å…¨å±€é€‰é¡¹] [å­å‘½ä»¤é€‰é¡¹]
```

### å…¨å±€é€‰é¡¹ ğŸŒ

- `--config <FILE>`ï¼šæŒ‡å®šé…ç½®æ–‡ä»¶è·¯å¾„ï¼ˆä¸å†™åˆ™ä½¿ç”¨é»˜è®¤è·¯å¾„ï¼Œé¦–æ¬¡è¿è¡Œä¼šè‡ªåŠ¨ç”Ÿæˆé…ç½®ï¼‰
- `-d, --debug`ï¼šå¯ç”¨è°ƒè¯•æ—¥å¿—
- `-h, --help`ï¼šæŸ¥çœ‹å¸®åŠ©

### æ¨¡å¼ä¸å‚æ•° ğŸ§­

æ‰€æœ‰å­å‘½ä»¤åŒæ—¶æ”¯æŒä½ç½®å‚æ•°ï¼ˆå…¼å®¹æ—§ç”¨æ³•ï¼‰å’Œé•¿å‚æ•°ï¼ˆæ›´æ˜“è¯»ï¼‰ã€‚

1) `wallpaper` â€” æå–å£çº¸ ğŸ–¼ï¸

```bash
lianpkg wallpaper [SEARCH] [RAW_OUT] [PKG_TEMP]
  --search <PATH> --raw-out <PATH> --pkg-temp <PATH>
```

- `SEARCH`/`--search`ï¼šå£çº¸æºç›®å½•ï¼ˆå¯¹åº” `wallpaper.workshop_path`ï¼‰ï¼Œé»˜è®¤æŒ‡å‘ Steam Workshop ç›®å½•ã€‚
- `RAW_OUT`/`--raw-out`ï¼šæ— éœ€è§£åŒ…çš„å£çº¸è¾“å‡ºç›®å½•ï¼ˆ`wallpaper.raw_output_path`ï¼‰ã€‚
- `PKG_TEMP`/`--pkg-temp`ï¼šä¸´æ—¶å­˜æ”¾ `.pkg` çš„ç›®å½•ï¼ˆ`wallpaper.pkg_temp_path`ï¼‰ï¼Œè§£åŒ…ç»“æŸå¯æŒ‰æ¸…ç†å¼€å…³åˆ é™¤ã€‚

2) `pkg` â€” è§£åŒ… `.pkg` ğŸ“¦

```bash
lianpkg pkg [INPUT] [OUTPUT]
  --input <PATH> --output <PATH>
```

- `INPUT`/`--input`ï¼šè¯»å– `.pkg` çš„ç›®å½•ï¼Œé»˜è®¤ä½¿ç”¨ `wallpaper.pkg_temp_path`ã€‚
- `OUTPUT`/`--output`ï¼šé¦–æ¬¡è§£åŒ…äº§ç‰©ç›®å½•ï¼ˆ`unpack.unpacked_output_path`ï¼‰ã€‚

3) `tex` â€” è½¬æ¢ `.tex` ğŸ§©

```bash
lianpkg tex [INPUT]
  --input <PATH> --output <PATH>
```

`--output` ä¼šè¦†ç›– `tex.converted_output_path`ï¼Œä¸å†™åˆ™ä½¿ç”¨é»˜è®¤çš„ `tex_converted` ç»“æ„ã€‚

- `INPUT`/`--input`ï¼šæŸ¥æ‰¾ `.tex` çš„ç›®å½•ï¼Œé»˜è®¤ä½¿ç”¨ `unpack.unpacked_output_path`ã€‚
- `--output`ï¼šæœ€ç»ˆå›¾ç‰‡è¾“å‡ºç›®å½•ï¼›ç•™ç©ºåˆ™åœ¨æ¯ä¸ªåœºæ™¯ä¸‹åˆ›å»º `tex_converted`ï¼Œä¿æŒåŸæœ‰å±‚çº§ã€‚

4) `auto` â€” ä¸€é”®æ‰§è¡Œ wallpaper -> pkg -> tex ğŸ¤–

```bash
lianpkg auto \
  [--search <PATH>] [--raw-out <PATH>] [--pkg-temp <PATH>] \
  [--input <PATH>] [--unpacked-out <PATH>] [--tex-out <PATH>] \
  [--no-clean-temp] [--no-clean-unpacked] [--dry-run]
```

- `--no-clean-temp`ï¼šç»“æŸæ—¶ä¿ç•™ `Pkg_Temp`
- `--no-clean-unpacked`ï¼šä¿ç•™ `Pkg_Unpacked`ï¼ˆä»ä¿ç•™ `tex_converted`ï¼‰
- `--dry-run`ï¼šä»…æ‰“å°è§£æåçš„è·¯å¾„ä¸æ¸…ç†è®¡åˆ’ï¼Œä¸æ‰§è¡Œä»»ä½•æ“ä½œ

- `--search`/`--raw-out`/`--pkg-temp`ï¼šè¦†ç›– wallpaper é˜¶æ®µè·¯å¾„ã€‚
- `--input`/`--unpacked-out`ï¼šè¦†ç›– pkg è§£åŒ…è¾“å…¥/è¾“å‡ºè·¯å¾„ã€‚
- `--tex-out`ï¼šè¦†ç›– tex æœ€ç»ˆè¾“å‡ºç›®å½•ï¼›é»˜è®¤ä½¿ç”¨ `tex_converted` ç»“æ„ã€‚
- `--no-clean-temp` å¯¹åº” `unpack.clean_pkg_temp`ï¼›`--no-clean-unpacked` å¯¹åº” `unpack.clean_unpacked`ã€‚

### å¹³å°å·®å¼‚ä¸è¿è¡Œæ–¹å¼ ğŸ–¥ï¸

- Linuxï¼šé»˜è®¤è·¯å¾„åŸºäº `~/.local/share`ï¼Œå‘½ä»¤è¡Œè¿è¡Œ `lianpkg ...`ã€‚
- Windowsï¼šé»˜è®¤è·¯å¾„åŸºäº exe åŒç›®å½•ï¼ˆä¾¿æºåŒ–ï¼‰ï¼›å¯åŒå‡»è¿è¡Œï¼Œæµç¨‹ç»“æŸä¼šæç¤ºæŒ‰ Enter é€€å‡ºï¼›ä¹Ÿå¯åœ¨ cmd/PowerShell è¿è¡Œ `lianpkg.exe ...`ã€‚

### é‡è¦æç¤º ğŸ“Œ

- é»˜è®¤è·¯å¾„å¯é€šè¿‡ CLI è¦†ç›–æˆ–ä¿®æ”¹ `config.toml`ã€‚
- æ¸…ç†å¼€å…³é»˜è®¤å¼€å¯ï¼ˆä¿ç•™ `tex_converted`ï¼‰ï¼Œå¯ç”¨ `--no-clean-temp` / `--no-clean-unpacked` å…³é—­ã€‚

### å¿«é€Ÿä¸Šæ‰‹ç¤ºä¾‹ â±ï¸

- ä¸€é”®æ‰§è¡Œé»˜è®¤æµç¨‹ï¼š`lianpkg auto`
- ä»…è§£åŒ…è‡ªå®šä¹‰è·¯å¾„ï¼š`lianpkg pkg /path/to/pkg /tmp/output`
- è½¬æ¢ `.tex` å¹¶æŒ‡å®šæœ€ç»ˆè¾“å‡ºï¼š`lianpkg tex /tmp/Pkg_Unpacked --output /tmp/tex_converted`
- åªæƒ³çœ‹çœ‹ä¼šåšä»€ä¹ˆï¼š`lianpkg auto --dry-run`

---

## å…è´£å£°æ˜ (Disclaimer) ğŸ“„

æœ¬å·¥å…·ä»…ä¾›å­¦ä¹ äº¤æµå’Œä¸ªäººå¤‡ä»½ä½¿ç”¨ã€‚

1. **ç‰ˆæƒå½’å±**: æœ¬å·¥å…·æå–å’Œè§£åŒ…çš„æ‰€æœ‰èµ„æºï¼ˆåŒ…æ‹¬ä½†ä¸é™äºå›¾ç‰‡ã€è§†é¢‘ã€è„šæœ¬ç­‰ï¼‰çš„ç‰ˆæƒå½’åŸä½œè€…æˆ– Wallpaper Engine æ‰€æœ‰ã€‚è¯·å‹¿å°†æå–çš„èµ„æºç”¨äºå•†ä¸šç”¨é€”æˆ–è¿ååŸä½œè€…è®¸å¯çš„ç”¨é€”ã€‚
2. **ä½¿ç”¨è´£ä»»**: ç”¨æˆ·åœ¨ä½¿ç”¨æœ¬å·¥å…·æ—¶åº”éµå®ˆç›¸å…³æ³•å¾‹æ³•è§„ã€‚å¯¹äºç”¨æˆ·ä½¿ç”¨æœ¬å·¥å…·æ‰€äº§ç”Ÿçš„ä»»ä½•åæœï¼ˆåŒ…æ‹¬ä½†ä¸é™äºç‰ˆæƒçº çº·ã€æ•°æ®ä¸¢å¤±ç­‰ï¼‰ï¼Œå¼€å‘è€…ä¸æ‰¿æ‹…ä»»ä½•è´£ä»»ã€‚
3. **éå®˜æ–¹å·¥å…·**: æœ¬é¡¹ç›®ä¸ Wallpaper Engine æˆ– Valve (Steam) æ²¡æœ‰ä»»ä½•å®˜æ–¹å…³è”ã€‚

---

## è‡´è°¢ä¸å‚è€ƒèµ„æ–™ ğŸ™

æœ¬é¡¹ç›®çµæ„Ÿæ¥æºäºå¯¹ç°æœ‰å·¥å…·çš„ç ”ç©¶ï¼Œè¿™äº›å·¥å…·ç”¨äºå¤„ç† Wallpaper Engine çš„èµ„æºæ ¼å¼ã€‚

- **RePKG**ï¼Œä½œè€… notscuffedï¼ˆMIT è®¸å¯è¯ï¼‰

ç”¨ä½œç†è§£ `.pkg` æ–‡ä»¶ç»“æ„çš„å‚è€ƒã€‚

- **we**ï¼Œä½œè€… redpfireï¼ˆGPL-3.0 è®¸å¯è¯ï¼‰

ç”¨äºæ–‡ä»¶æ ¼å¼åˆ†æå’Œè§£åŒ…é€»è¾‘ã€‚

æœ¬é¡¹ç›®æœªå¤åˆ¶ä»»ä½•æºä»£ç ï¼›LianPkg æ˜¯ä¸€ä¸ªå®Œå…¨ç‹¬ç«‹äºæºä»£ç çš„ Rust é‡å†™ç‰ˆæœ¬ã€‚

æœ¬é¡¹ç›®ä¸ Wallpaper Engineã€Valve æˆ–ä¸Šè¿°å·¥å…·çš„ä½œè€…å‡æ— ä»»ä½•å…³è”ã€‚
